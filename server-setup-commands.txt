# Katha Sales Server Setup Commands
# Run these commands on the server after connecting via VS Code Remote-SSH

# 1. Go to web directory
cd /var/www

# 2. Remove old project if exists
rm -rf katha-sales

# 3. Clone fresh project from GitHub
git clone https://github.com/gauav9982/katha-123.git katha-sales

# 4. Go to project directory
cd katha-sales

# 5. Install all dependencies
npm run install:all

# 6. Setup database
npm run setup

# 7. Build frontend
cd frontend
npm run build
cd ..

# 8. Set proper permissions
chown -R www-data:www-data /var/www/katha-sales
chmod -R 755 /var/www/katha-sales

# 9. Copy nginx configuration
cp config/nginx-katha.conf /etc/nginx/sites-available/katha-sales
ln -sf /etc/nginx/sites-available/katha-sales /etc/nginx/sites-enabled/

# 10. Start services
pm2 start ecosystem.config.cjs
systemctl start nginx

# 11. Check if everything is working
pm2 status
systemctl status nginx

# 12. Test the application
curl http://localhost:4000/api/health
curl http://localhost

# Your application should now be live at: http://168.231.122.33 